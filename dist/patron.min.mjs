function e(e,t){if(void 0===e)throw new Error("give didnt receive data argument");if(void 0===t)throw new Error("give didnt receive guest argument");"function"==typeof t?t(e):t.give(e)}function t(e){if(void 0===e)throw new Error("isGuest didnt receive mbGuest argument");return"function"==typeof e||"function"==typeof e?.give}class r{constructor(e){if(this.receiver=e,!e)throw new Error("reseiver function was not passed to Guest constructor")}give(e){return this.receiver(e),this}}class i{constructor(e,t){if(this.sourceGuest=e,this.targetGuest=t,void 0===e)throw new Error("GuestCast didnt receive sourceGuest argument");if(void 0===t)throw new Error("GuestCast didnt receive targetGuest argument")}introduction(){return"function"==typeof this.sourceGuest?"guest":this.sourceGuest.introduction?this.sourceGuest.introduction():"guest"}give(t){return e(t,this.targetGuest),this}disposed(e){const t=this.sourceGuest;return!!t.disposed&&t.disposed(e)}}var s=Object.defineProperty,o=(e,t,r)=>((e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const n=new Map,u=e=>{const t=[];return n.forEach(((r,i)=>{r.has(e)&&t.push(i)})),t},c=e=>{if(void 0===e)throw new Error("removePatronFromPools didnt receive patron argument");n.forEach((t=>{t.delete(e)}))},h=e=>{if(void 0===e)throw new Error("isPatronInPools didnt receive patron argument");let t=!1;return n.forEach((r=>{t||(t=r.has(e))})),t};class a{constructor(e){this.initiator=e,o(this,"patrons"),o(this,"give"),this.patrons=new Set,n.set(this,this.patrons);const t=e=>{this.patrons.forEach((t=>{this.sendValueToGuest(e,t)}))};this.give=e=>(t(e),this)}size(){return this.patrons.size}add(e){if(!e)throw new Error("PatronPool add method received nothing!");return"function"!=typeof e&&e.introduction&&"patron"===e.introduction()&&this.patrons.add(e),this}remove(e){return this.patrons.delete(e),this}distribute(e,t){return this.add(t),this.sendValueToGuest(e,t),this}sendValueToGuest(t,r){this.guestDisposed(t,r)||e(t,r)}guestDisposed(e,t){return!!t.disposed?.(e)&&(this.remove(t),!0)}}var l=Object.defineProperty,d=(e,t,r)=>((e,t,r)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class v{constructor(e){d(this,"guests",new Set),d(this,"patronPool"),this.patronPool=new a(e)}give(e){return this.deliverToGuests(e),this.patronPool.give(e),this}add(e){return"function"!=typeof e&&e.introduction&&"guest"!==e.introduction()||this.guests.add(e),this.patronPool.add(e),this}remove(e){return this.guests.delete(e),this.patronPool.remove(e),this}distribute(e,t){return this.add(t),this.give(e),this}size(){return this.patronPool.size()+this.guests.size}deliverToGuests(t){this.guests.forEach((r=>{e(t,r)})),this.guests.clear()}}class g{constructor(e){if(this.theValue=e,void 0===e)throw new Error("GuestSync didnt receive theValue argument")}give(e){return this.theValue=e,this}value(){return this.theValue}}class w{constructor(e){if(this.baseGuest=e,void 0===e)throw new Error("GuestObject didnt receive baseGuest argument")}give(e){let t=this.baseGuest;return"function"==typeof t&&(t=new r(t)),t.give(e),this}introduction(){return"function"!=typeof this.baseGuest&&this.baseGuest.introduction?this.baseGuest.introduction():"guest"}disposed(e){const t=this.baseGuest;return!!t.disposed&&t.disposed(e)}}class f{constructor(e,t){if(this.guest=e,this.disposeCheck=t,void 0===e)throw new Error("GuestDisposable didnt receive guest argument");if(void 0===t)throw new Error("GuestDisposable didnt receive disposeCheck argument")}disposed(e){return this.disposeCheck(e)}give(t){return e(t,this.guest),this}}class p{constructor(e,t){this.baseGuest=e,this.applier=t}give(t){return e(this.applier(t),this.baseGuest),this}}var b=Object.defineProperty,m=(e,t,r)=>((e,t,r)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,t+"",r);class y{constructor(t,r){m(this,"give"),this.give=r((r=>e(r,t)))}}class E{constructor(e){if(this.willBePatron=e,void 0===e)throw new Error("Patron didnt receive willBePatron argument")}introduction(){return"patron"}give(t){return e(t,this.willBePatron),this}disposed(e){const t=this.willBePatron;return t?.disposed?.(e)||!1}}const P=e=>"object"==typeof e&&null!==e&&"patron"===e?.introduction?.();var G=Object.defineProperty,S=(e,t,r)=>((e,t,r)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,t+"",r);class A{constructor(e){if(this.baseGuest=e,S(this,"received",!1),void 0===e)throw new Error("PatronOnce didnt receive baseGuest argument")}introduction(){return"patron"}give(t){return this.received||(this.received=!0,e(t,this.baseGuest)),this}disposed(e){if(this.received)return!0;const t=this.baseGuest;return!!t.disposed&&t.disposed(e)}}var F=Object.defineProperty,D=(e,t,r)=>((e,t,r)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class j{constructor(e){this.sourceDocument=e,D(this,"thePool",new a(this)),D(this,"theEmptyPool",new a(this)),D(this,"isEmpty"),this.isEmpty=void 0===e}pool(){return this.thePool}give(e){return this.isEmpty=!1,this.sourceDocument=e,this.thePool.give(this.sourceDocument),this.theEmptyPool.give(this.sourceDocument),this}value(e){return this.isEmpty?(P(e)&&this.theEmptyPool.add(e),this):("function"==typeof e?this.thePool.distribute(this.sourceDocument,new r(e)):this.thePool.distribute(this.sourceDocument,e),this)}filled(){return!this.isEmpty}}var O=Object.defineProperty,k=(e,t,r)=>((e,t,r)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class z{constructor(e=[]){k(this,"theAll"),k(this,"keysKnown"),k(this,"keysFilled",new Set),k(this,"filledAllPool",new v(this)),this.theAll=new j({}),this.keysKnown=new Set(e)}valueArray(e){const t=new w(e);return this.filledAllPool.add(new i(t,(e=>{t.give(Object.values(e))}))),this.isAllFilled()&&this.theAll.value(new r((e=>{this.filledAllPool.give(Object.values(e))}))),this}value(e){const t=new w(e);return this.isAllFilled()?(this.filledAllPool.add(t),this.theAll.value(new r((e=>{this.filledAllPool.give(e)})))):this.filledAllPool.add(t),this}guestKey(e){return this.keysKnown.add(e),new r((t=>{this.theAll.value(new r((r=>{this.keysFilled.add(e);const i={...r,[e]:t};this.theAll.give(i),this.isAllFilled()&&this.filledAllPool.give(i)})))}))}isAllFilled(){return this.keysFilled.size>0&&this.keysFilled.size===this.keysKnown.size}}function K(e,t){if(void 0===e)throw new Error("value didnt receive source argument");if(void 0===t)throw new Error("value didnt receive guest argument");return"function"==typeof e?e(t):e.value(t)}function V(e){if(void 0===e)throw new Error("isSource didnt receive mbSource argument");return"function"==typeof e||"function"==typeof e?.value}class C{constructor(e){if(this.source=e,void 0===e)throw new Error("Source constructor didnt receive executor function")}value(e){return K(this.source,e),e}}const x=t=>new C((r=>e(t,r)));class T{constructor(e,t){if(this.baseSource=e,this.targetSource=t,void 0===e)throw new Error("SourceSequence didnt receive baseSource argument");if(void 0===t)throw new Error("SourceSequence didnt receive targetSource argument")}value(t){const r=new z,s=new j,o=this.targetSource.get(s);return K(this.baseSource,new i(t,(i=>{let n=0;const u=()=>{void 0!==i[n+1]?(n+=1,c()):r.valueArray(t)};function c(){s.give(null);const e=i[n];V(e)?K(e,new A((e=>{s.give(e),K(o,r.guestKey(n.toString())),u()}))):(s.give(e),K(o,r.guestKey(n.toString())),u())}void 0!==i[n]?c():e([],t)}))),this}}class B{constructor(e,t){if(this.baseSource=e,this.targetSource=t,void 0===e)throw new Error("SourceMap didnt receive baseSource argument");if(void 0===t)throw new Error("SourceMap didnt receive targetSource argument")}value(t){const r=new z;return K(this.baseSource,new i(t,(t=>{t.forEach(((t,i)=>{const s=V(t)?t:new C((r=>{e(t,r)}));K(this.targetSource.get(s),r.guestKey(i.toString()))}))}))),r.valueArray(t),this}}class M{constructor(e){if(this.sources=e,void 0===e)throw new Error("SourceRace didnt receive sources argument")}value(t){let r=null;return this.sources.forEach((s=>{K(s,new i(t,(i=>{r&&r!==s||(e(i,t),r=s)})))})),this}}var q=Object.defineProperty,I=(e,t,r)=>((e,t,r)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,t+"",r);class N{constructor(e){if(this.configExecutor=e,I(this,"source",new j),void 0===e)throw new Error("SourceActive constructor didnt receive executor function")}do(e){return this.configExecutor(e,this.source),this}value(e){return this.source.value(e),this}}class R{constructor(e,t){if(this.baseGuest=e,this.baseSource=t,void 0===e)throw new Error("SourceDynamic didnt receive baseGuest argument");if(void 0===t)throw new Error("SourceDynamic didnt receive baseSource argument")}value(e){return K(this.baseSource,e),this}give(t){return e(t,this.baseGuest),this}pool(){throw Error("No pool in SourceDynamic")}}class H{constructor(e,t){this.baseSource=e,this.applier=t}value(t){return K(this.baseSource,new i(t,(r=>{e(this.applier(r),t)}))),this}}var J=Object.defineProperty,L=(e,t,r)=>((e,t,r)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,t+"",r);class Q{constructor(e,t){L(this,"value"),this.value=t((t=>{K(e,t)}))}}class U{constructor(e,t={}){if(this.constructorFn=e,this.modules=t,void 0===e)throw new Error("PrivateClass didnt receive constructorFn argument")}get(...e){return new this.constructorFn(...e,this.modules)}}class W{constructor(e){if(this.buildingFn=e,void 0===e)throw new Error("Private didnt receive buildingFn argument")}get(...e){return this.buildingFn(...e)}}export{r as Guest,p as GuestApplied,i as GuestCast,f as GuestDisposable,y as GuestExecutorApplied,w as GuestObject,v as GuestPool,g as GuestSync,E as Patron,A as PatronOnce,a as PatronPool,W as Private,U as PrivateClass,C as Source,N as SourceActive,z as SourceAll,H as SourceApplied,R as SourceDynamic,Q as SourceExecutorApplied,B as SourceMap,M as SourceRace,T as SourceSequence,j as SourceWithPool,e as give,t as isGuest,P as isPatron,h as isPatronInPools,V as isSource,u as patronPools,c as removePatronFromPools,x as sourceOf,K as value};
//# sourceMappingURL=patron.min.mjs.map
